# Specification: 画面下部更新不具合修正

## 1. 概要
`uv run samples/color_test_fix.py` の実行において、ST7789Vディスプレイの画面下部が正しく更新されない問題を修正する。

## 2. 問題の詳細
- ユーザーが提供した写真 (`figs3` ディレクトリ内) にて、ディスプレイ下部が更新されずに前回の表示内容が残存していることが確認された。
- この問題は、RGBカラーマッピングの修正後に顕在化した。

## 3. 根本原因の仮説
- ディスプレイコントローラ（ST7789V）へのコマンド送信において、描画領域の設定（特に列アドレスや行アドレス）が不適切である可能性がある。
- ディスプレイの物理的なオフセットや有効表示領域が、ドライバの実装と合致していない可能性がある。

## 4. 解決策の提案
- ST7789Vデータシートを再確認し、描画領域設定に関連するレジスタ（CASET, RASETなど）の動作を深く理解する。
- `st7789v.py` の `_set_window` メソッドにおける座標計算とコマンド送信ロジックを修正する。

## 5. 受け入れ基準
- `samples/color_test_fix.py` や新規に作成されるテストスクリプトを実行した際に、ディスプレイの全領域（特に下部）が意図通りに更新されること。
- 画面の描画に乱れがなく、正しく表示されること。
- 既存の機能（他のサンプルやテスト）が引き続き正常に動作すること。

## 6. スコープ外
- 文字列の表示の乱れ（これは別のトラックで対応する）。
- パフォーマンスの最適化（本トラックでは不具合修正に注力する）。
