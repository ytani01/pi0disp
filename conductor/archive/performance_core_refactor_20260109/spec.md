# Specification: `performance_core_refactor_20260109`

## 1. Overview
`src/pi0disp/utils/performance_core.py` は初期設計に基づいた抽象化が含まれていますが、現在の `ST7789V` ドライバの実装や `sprite.py` の導入により、一部の機能が重複、あるいは過剰に複雑になっています。本トラックでは、**後方互換性を考慮せず**、これらを現在の最適化手法（Dirty Rectangle 等）に適合するようにゼロベースでリファクタリングし、シンプルかつ強力な描画基盤へと刷新します。あわせて、詳細なリファレンスと実用的なサンプルを提供します。

## 2. Functional Requirements (機能要件)
### 2.1 リファクタリング
- **不要な抽象化の完全排除**: 現在のプロジェクト規模に合わない過剰なクラス階層や冗長なメソッドを削除し、必要最小限で洗練された API に再構成する。
- **機能重複の解消**: `st7789v.py` や `sprite.py` と重複するロジックを排除し、`performance_core` が担うべき「効率的な描画ループと実行制御」に特化させる。
- **API の刷新**: 既存の依存関係を気にせず、最も合理的で使いやすいメソッド名や引数に整理する。

### 2.2 パフォーマンス最適化
- **ドライバ最適化の反映**: `ST7789V` ドライバが持つ Dirty Rectangle 機能を最大限に活かせるよう、コアの描画フローを最適化する。

### 2.3 ドキュメント（マニュアル）作成
- **リファレンス・マニュアル**: 刷新された各クラス・メソッドの役割、技術仕様を網羅したドキュメント。
- **クイックスタート**: 最小限のコードで動作を開始できるチュートリアル。
- **最適化ガイド**: CPU負荷を抑えるための実装パターンと解説。
- **実用サンプル**: 複数オブジェクトの同時描画や高速更新など、具体的なコード例。

## 3. Non-Functional Requirements (非機能要件)
- **コードの簡潔さ**: リファクタリング後は、現在の実装よりも大幅にコード行数を削減し、見通しを良くする。
- **保守性**: `__slots__` の活用など、属性アクセスの高速化とメモリ効率の向上を図る。

## 4. Acceptance Criteria (受け入れ基準)
- `performance_core.py` が洗練された構造に書き換えられ、テストがすべてパスすること。
- 不要なコードや古い抽象化が完全に削除されていること。
- 新しいマニュアル（Markdown形式）が作成され、すべてのサンプルコードが意図通りに動作すること。

## 5. Out of Scope (スコープ外)
- ディスプレイドライバ自体の根本的な書き換え。
- `performance_core.py` 以外のユーティリティの広範囲な修正（必要最小限の調整に留める）。
