# Track Specification: 統合型インタラクティブ LCD 設定ウィザード

## 1. 概要 (Overview)
`pi0disp lcd-check --wizard` を、画面の向き、色反転、BGR設定をすべてリアルタイムに切り替えながら調整できる統合ウィザードに刷新する。ユーザーは目視で「背景が黒、上が赤、緑、青」の順に見えるようにキーで調整し、最後に一括保存する。

## 2. 機能要件 (Functional Requirements)
- **統合調整ループ**: 
    - 以下のキー入力を受け付け、即座に表示を更新する。
        - `a, b, c, d`: 回転角を 0, 90, 180, 270 度に設定
        - `i`: `invert` 設定をトグル (True/False)
        - `g`: `bgr` 設定をトグル (True/False)
        - `ENTER`: 現在の全設定（rotation, invert, bgr）を `pi0disp.toml` に保存して終了
        - `q`: 中断
- **フルリフレッシュの強制**:
    - 設定（rotation/invert/bgr）が変更された際は、ドライバの差分更新用キャッシュをクリアし、画面全体の描き直しを強制することで残像を防止する。
- **視覚的フィードバック**:
    - 標準テストパターンを使用。
    - 現在適用されている設定値を画面端にテキストで表示する。
- **一括保存**:
    - `tomlkit` を使用し、`pi0disp.toml` の該当項目を一度に更新する。

## 3. 非機能要件 (Non-Functional Requirements)
- **UX の一貫性**: 複数のフェーズに分かれず、一つの画面ですべて完結させる。
- **堅牢性**: キャッシュクリアにより、回転切り替え時の描画崩れを完全に排除する。

## 4. 受け入れ条件 (Acceptance Criteria)
- `pi0disp lcd-check --wizard` で一つの調整ループが起動すること。
- キー操作により向き、反転、BGRが即座に切り替わり、残像が発生しないこと。
- `ENTER` を押すと、その時のすべての設定が `pi0disp.toml` に反映されること。
- その後、正常終了すること。
